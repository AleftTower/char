-- Xeno Script: Chat Commands Toggle (G for Char, F for Fly2)
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = game:GetService("TextChatService")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- وظيفة لإرسال الرسالة في الشات (تدعم النظامين القديم والجديد)
local function sendChatMessage(message)
    -- نظام الشات القديم
    local defaultChatSystem = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
    if defaultChatSystem then
        local sayMessageRequest = defaultChatSystem:FindFirstChild("SayMessageRequest")
        if sayMessageRequest then
            sayMessageRequest:FireServer(message, "All")
            return
        end
    end

    -- نظام الشات الجديد
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        local generalChannel = TextChatService:FindFirstChild("TextChannels") and TextChatService.TextChannels:FindFirstChild("RBXGeneral")
        if generalChannel then
            generalChannel:SendAsync(message)
            return
        end
    end
end

-- وظيفة الحصول على اللاعب تحت الماوس وإرسال الأمر
local function sendCommandToTarget(commandPrefix, extraArgs)
    local targetPart = Mouse.Target
    if targetPart then
        local character = targetPart.Parent
        -- التحقق من الملحقات
        if character and (character:IsA("Accessory") or character:IsA("Tool")) then
            character = character.Parent
        end

        local targetPlayer = Players:GetPlayerFromCharacter(character)
        if targetPlayer and targetPlayer ~= LocalPlayer then
            local targetName = targetPlayer.Name
            local fullCommand = commandPrefix .. " " .. targetName .. (extraArgs or "")
            sendChatMessage(fullCommand)
        end
    end
end

-- الكشف عن ضغطات الأزرار
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end -- تجاهل الضغط أثناء الكتابة في الشات
    
    -- حرف G لإرسال أمر الكار
    if input.KeyCode == Enum.KeyCode.G then
        sendCommandToTarget("/e /char")
        
    -- حرف F لإرسال أمر الفلاي 2 مع سرعة 100
    elseif input.KeyCode == Enum.KeyCode.F then
        sendCommandToTarget("/fly2", " 100")
    end
end)

-- إشعار عند التشغيل
StarterGui:SetCore("SendNotification", {
    Title = "Multi-Command Active";
    Text = "G: /char | F: /fly2 (100)";
    Duration = 5;
})
